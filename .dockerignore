Hi, I'm trying to fix my Fly.io deployment. There's a build error on my Dockerfile.

Please fix my Dockerfile for me to the best of your ability. And give me the updated version so I can paste in Fly.io web deployment UI.

Error logs:

```
flyctl deploy --build-only --push -a beberaygardonsellviastore --image-label deployment-0ebe02c35bca377d5c626ebf4481c605 
==> Verifying app config
--> Verified app config
Validating /usr/src/app/fly.toml
[32mâœ“[0m Configuration is valid
==> Building image
Waiting for depot builder...

==> Building image with Depot
--> build:  (â€‹)
#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.12kB 0.0s done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/node:18
#2 DONE 0.6s

#3 [internal] load .dockerignore
#3 transferring context: 422B done
#3 DONE 0.0s

#4 [internal] load build context
#4 transferring context: 10.11kB done
#4 DONE 0.0s

#5 [build 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#5 resolve docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783 done
#5 DONE 0.0s

#5 [build 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#5 sha256:461077a72fb7fe40d34a37d6a1958c4d16772d0dd77f572ec50a1fdc41a3754d 446B / 446B 0.1s done
#5 sha256:cda7f44f2bddcc4bb7514474024b3f3705de00ddb6355a33be5ac7808e5b7125 3.32kB / 3.32kB 0.1s done
#5 sha256:3697be50c98b9d071df4637e1d3491d00e7b9f3a732768c876d82309b3c5a145 1.25MB / 1.25MB 0.1s done
#5 sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 9.44MB / 45.68MB 0.3s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 0B / 211.36MB 0.2s
#5 sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 2.29MB / 64.40MB 0.2s
#5 sha256:37927ed901b1b2608b72796c6881bf645480268eca4ac9a37b9219e050bb4d84 0B / 24.02MB 0.2s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 0B / 48.49MB 0.2s
#5 sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 15.73MB / 45.68MB 0.5s
#5 sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 9.44MB / 64.40MB 0.3s
#5 sha256:37927ed901b1b2608b72796c6881bf645480268eca4ac9a37b9219e050bb4d84 4.19MB / 24.02MB 0.3s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 6.29MB / 48.49MB 0.3s
#5 sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 23.07MB / 45.68MB 0.6s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 12.58MB / 211.36MB 0.5s
#5 sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 14.68MB / 64.40MB 0.5s
#5 sha256:37927ed901b1b2608b72796c6881bf645480268eca4ac9a37b9219e050bb4d84 9.44MB / 24.02MB 0.5s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 12.58MB / 48.49MB 0.5s
#5 sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 29.98MB / 45.68MB 0.8s
#5 sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 22.02MB / 64.40MB 0.6s
#5 sha256:37927ed901b1b2608b72796c6881bf645480268eca4ac9a37b9219e050bb4d84 16.78MB / 24.02MB 0.6s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 17.83MB / 48.49MB 0.6s
#5 sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 36.70MB / 45.68MB 0.9s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 25.17MB / 211.36MB 0.8s
#5 sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 30.77MB / 64.40MB 0.8s
#5 sha256:37927ed901b1b2608b72796c6881bf645480268eca4ac9a37b9219e050bb4d84 24.02MB / 24.02MB 0.7s done
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 24.12MB / 48.49MB 0.8s
#5 sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 41.94MB / 45.68MB 1.1s
#5 sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 49.28MB / 64.40MB 0.9s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 30.41MB / 48.49MB 0.9s
#5 sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 45.68MB / 45.68MB 1.1s done
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 47.19MB / 211.36MB 1.2s
#5 sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 64.40MB / 64.40MB 1.1s done
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 36.19MB / 48.49MB 1.1s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 61.87MB / 211.36MB 1.4s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 45.09MB / 48.49MB 1.2s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 80.74MB / 211.36MB 1.5s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 48.49MB / 48.49MB 1.4s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 98.57MB / 211.36MB 1.7s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 117.44MB / 211.36MB 1.8s
#5 sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 48.49MB / 48.49MB 1.7s done
#5 extracting sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 135.27MB / 211.36MB 2.0s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 152.04MB / 211.36MB 2.1s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 168.82MB / 211.36MB 2.3s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 185.60MB / 211.36MB 2.4s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 202.38MB / 211.36MB 2.6s
#5 sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 211.36MB / 211.36MB 4.6s done
#5 extracting sha256:3e6b9d1a95114e19f12262a4e8a59ad1d1a10ca7b82108adcf0605a200294964 3.0s done
#5 extracting sha256:37927ed901b1b2608b72796c6881bf645480268eca4ac9a37b9219e050bb4d84
#5 extracting sha256:37927ed901b1b2608b72796c6881bf645480268eca4ac9a37b9219e050bb4d84 0.5s done
#5 DONE 5.3s

#5 [build 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#5 extracting sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0
#5 extracting sha256:79b2f47ad4443652b9b5cc81a95ede249fd976310efdbee159f29638783778c0 2.1s done
#5 DONE 7.3s

#5 [build 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#5 extracting sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab
#5 extracting sha256:e23f099911d692f62b851cf49a1e93294288a115f5cd2d014180e4d3684d34ab 5.2s done
#5 DONE 12.6s

#5 [build 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#5 extracting sha256:cda7f44f2bddcc4bb7514474024b3f3705de00ddb6355a33be5ac7808e5b7125 0.0s done
#5 extracting sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7
#5 extracting sha256:c6b30c3f16966552af10ac00521f60355b1fcfd46ac1c20b1038587e28583ce7 2.2s done
#5 DONE 14.8s

#5 [build 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#5 extracting sha256:3697be50c98b9d071df4637e1d3491d00e7b9f3a732768c876d82309b3c5a145 0.1s done
#5 DONE 14.9s

#5 [build 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#5 extracting sha256:461077a72fb7fe40d34a37d6a1958c4d16772d0dd77f572ec50a1fdc41a3754d
#5 extracting sha256:461077a72fb7fe40d34a37d6a1958c4d16772d0dd77f572ec50a1fdc41a3754d 0.2s done
#5 DONE 15.1s

#6 [build 2/5] WORKDIR /usr/src/app
#6 DONE 12.1s

#7 [build 3/5] COPY package*.json ./
#7 DONE 0.0s

#8 [build 4/5] RUN npm install
#8 0.697 npm error code ENOENT
#8 0.697 npm error syscall open
#8 0.698 npm error path /usr/src/app/package.json
#8 0.698 npm error errno -2
#8 0.698 npm error enoent Could not read package.json: Error: ENOENT: no such file or directory, open '/usr/src/app/package.json'
#8 0.698 npm error enoent This is related to npm not being able to find a file.
#8 0.698 npm error enoent
#8 0.700 npm error A complete log of this run can be found in: /root/.npm/_logs/2026-02-08T20_03_44_469Z-debug-0.log
#8 ERROR: process "/bin/sh -c npm install" did not complete successfully: exit code: 254
------
 > [build 4/5] RUN npm install:
0.697 npm error code ENOENT
0.697 npm error syscall open
0.698 npm error path /usr/src/app/package.json
0.698 npm error errno -2
0.698 npm error enoent Could not read package.json: Error: ENOENT: no such file or directory, open '/usr/src/app/package.json'
0.698 npm error enoent This is related to npm not being able to find a file.
0.698 npm error enoent
0.700 npm error A complete log of this run can be found in: /root/.npm/_logs/2026-02-08T20_03_44_469Z-debug-0.log
------
==> Building image
Waiting for depot builder...

==> Building image with Depot
--> build:  (â€‹)
#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.12kB done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/node:18
#2 DONE 0.2s

#3 [internal] load .dockerignore
#3 transferring context: 422B done
#3 DONE 0.0s

#4 [stage-1 1/5] FROM docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783
#4 resolve docker.io/library/node:18@sha256:c6ae79e38498325db67193d391e6ec1d224d96c693a8a4d943498556716d3783 done
#4 DONE 0.0s

#5 [stage-1 2/5] WORKDIR /usr/src/app
#5 CACHED

#6 [internal] load build context
#6 transferring context: 385B done
#6 DONE 0.0s

#7 [build 3/5] COPY package*.json ./
#7 CACHED

#8 [build 4/5] RUN npm install
#8 0.689 npm error code ENOENT
#8 0.690 npm error syscall open
#8 0.690 npm error path /usr/src/app/package.json
#8 0.690 npm error errno -2
#8 0.690 npm error enoent Could not read package.json: Error: ENOENT: no such file or directory, open '/usr/src/app/package.json'
#8 0.690 npm error enoent This is related to npm not being able to find a file.
#8 0.690 npm error enoent
#8 0.692 npm error A complete log of this run can be found in: /root/.npm/_logs/2026-02-08T20_03_45_881Z-debug-0.log
#8 ERROR: process "/bin/sh -c npm install" did not complete successfully: exit code: 254
------
 > [build 4/5] RUN npm install:
0.689 npm error code ENOENT
0.690 npm error syscall open
0.690 npm error path /usr/src/app/package.json
0.690 npm error errno -2
0.690 npm error enoent Could not read package.json: Error: ENOENT: no such file or directory, open '/usr/src/app/package.json'
0.690 npm error enoent This is related to npm not being able to find a file.
0.690 npm error enoent
0.692 npm error A complete log of this run can be found in: /root/.npm/_logs/2026-02-08T20_03_45_881Z-debug-0.log
------
Error: failed to fetch an image or build from source: error building: failed to solve: process "/bin/sh -c npm install" did not complete successfully: exit code: 254
Dockerfile failed to build error
```

Dockerfile


```
# Stage 1: Build the Application
# We use node:18 as the base for building and installing dependencies.
FROM node:18 AS build

# Set the working directory inside the container
WORKDIR /usr/src/app

# Copy package.json and package-lock.json first to leverage Docker caching.
# If these files don't change, subsequent builds can skip 'npm install'.
COPY package*.json ./

# Install dependencies
RUN npm install

# Copy the rest of the application source code
COPY . .

# Stage 2: Create the Final Production Image
# We use node:18 as the runtime image with all the necessary tools.
FROM node:18

# Set the working directory
WORKDIR /usr/src/app

# Copy the node_modules and built application files from the 'build' stage
COPY --from=build /usr/src/app/node_modules ./node_modules
COPY --from=build /usr/src/app/package*.json ./
COPY --from=build /usr/src/app .

# Expose the port your app runs on
ENV PORT=8080
EXPOSE $PORT

# Run the application using the non-root user (recommended for security)
USER node

# Define the command to start your application
CMD [ "node", "index.js" ]

```


.dockerignore


```
# Dependency/Build Directories
node_modules
npm-debug.log
.npm

# Project Files
.git
.gitignore
.dockerignore
Dockerfile
fly.toml # Fly.io configuration file

# Environment/Configuration Files
.env
.DS_Store
*.log

# Development/Testing files and directories (adjust as needed)
test
tests
docs
coverage
tmp
*~
# Any files generated during development or testing, e.g.:
dist
build

```


fly.toml


```
# fly.toml app configuration file generated for beberaygardonsellviastore on 2026-02-08T20:02:45Z
#
# See https://fly.io/docs/reference/configuration/ for information about how to use this file.
#

app = 'beberaygardonsellviastore'
primary_region = 'ord'

[build]

[http_service]
  internal_port = 8080
  force_https = true
  auto_stop_machines = 'stop'
  auto_start_machines = true
  min_machines_running = 0
  processes = ['app']

[[vm]]
  memory = '1gb'
  cpu_kind = 'shared'
  cpus = 1
  memory_mb = 1024

```

